%-----------------------------------------------------------------------------%
% Bibliography setup for papers
%-----------------------------------------------------------------------------%
% \RequirePackage[superscript,biblabel]{cite}
% \RequirePackage[super,comma,sort&compress]{natbib}
\RequirePackage[biblabel]{cite}
\RequirePackage[comma,compress]{natbib}
\RequirePackage{bibentry}
\RequirePackage{etoolbox}
\setcitestyle{citesep={,},aysep={}}

% Re-design of citation commands with active 'super' option
% See: https://tex.stackexchange.com/q/420370/73149
% See: https://tex.stackexchange.com/q/36235/73149
% NOTE: Instead use native commands with optional prefixes. And mixing
% superscript style with full style is dumb, just forget it.
% \renewcommand\citet[1]{\citeauthor{#1} (\citeyear{#1}) [\citenum{#1}]}
% \renewcommand\citep[1]{\citeauthor{#1}, \citeyear{#1} [\citenum{#1}]}
% \renewcommand\citet[1]{\citeauthor{#1} (\citeyear{#1})} % repair
% \renewcommand\citep[1]{\citeauthor{#1}, \citeyear{#1}}

% Make author names italic; from https://tex.stackexchange.com/a/47088/73149
\patchcmd{\NAT@test}%
{\else\NAT@nm}%
{\else\NAT@nmfmt{\NAT@nm}}%
{}%
{}%
\let\NAT@up\itshape

% Use 1. instead of [1] for bibliography
% \makeatletter\renewcommand\@biblabel[1]{#1.}\makeatother
\renewcommand\@biblabel[1]{#1.}

% Improved overline
\newcommand*{\extraline}[1]{%
  $\m@th\overline{\raisebox{0pt}[\dimexpr\height+1mm\relax]{#1}}$%
}

% Completely remove bibliography numbers; see https://tex.stackexchange.com/a/35371/73149
% Also fixes indentation w.r.t. the no numbers
\renewcommand\@biblabel[1]{}\renewenvironment{thebibliography}[1]{%
  \section*{\refname}%
  \@mkboth{\MakeUppercase\refname}{\MakeUppercase\refname}%
  \list{}{%
    \leftmargin0pt\@openbib@code\usecounter{enumiv}%
  }%
  \sloppy%
  \clubpenalty4000\@clubpenalty \clubpenalty\widowpenalty4000%
  \sfcode`\.\@m%
}{%
  \def\@noitemerr{\@latex@warning{Empty `thebibliography' environment}}%
  \endlist%
}
